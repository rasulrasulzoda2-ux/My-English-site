<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test: Present Continuous</title>
  <link rel="stylesheet" href="../../CSS/style.css">
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>
  <header>
    <div class="header-content">
      <h1>Present Continuous Test</h1>
      <p>Test your knowledge of ongoing actions and temporary situations</p>
    </div>
  </header>

  <nav>
    <div class="nav-container">
      <input type="checkbox" id="mobile-menu-toggle" class="mobile-menu-toggle">
      <label for="mobile-menu-toggle" class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </label>
      <ul>
        <li><a href="index.html" class="nav-active">Home</a></li>
        <li>
          <a href="../../HTML/rules/rules.html">Grammar Rules</a>
          <ul>
            <li><a href="../../HTML/rules/rule-present-simple.html">Present Simple</a></li>
            <li><a href="../../HTML/rules/rule-present-continuous.html">Present Continuous</a></li>
            <li><a href="../../HTML/rules/rule-past-simple.html">Past Simple</a></li>
            <li><a href="../../HTML/rules/rule-future-simple.html">Future Simple</a></li>
            <li><a href="../../HTML/rules/rule-articles.html">Articles</a></li>
          </ul>
        </li>
        <li>
          <a href="../../HTML/dictionary/dictionary.html">Dictionary</a>
          <ul>
            <li><a href="../../HTML/dictionary/verbs.html">Irregular Verbs</a></li>
            <li><a href="../../HTML/dictionary/word-cards.html">Word Cards</a></li>
          </ul>
        </li>
        <li>
          <a href="../../HTML/tests/tests.html">Tests</a>
          <ul>
            <li><a href="../../HTML/tests/comperalative.html">Comparative & Superlative</a></li>
            <li><a href="../../HTML/tests/past-simple-test.html">Past Simple Test</a></li>
            <li><a href="../../HTML/tests/present-simple-test.html">Present Simple Test</a></li>
            <li><a href="../../HTML/tests/present-continuous-test.html">Present Continuous Test</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>
  
  <main>
    <section class="hero">
      <div class="hero-content">
        <h2>Present Continuous Tense Test</h2>
        <p>Test your understanding of actions happening now and temporary situations</p>
      </div>
    </section>

    <div class="test-instructions">
      <h3>Test Instructions</h3>
      <p>You have <strong>10 minutes</strong> to complete 20 questions. Choose the correct form of the verb for each sentence. Good luck!</p>
    </div>

    <div class="intro" id="introSection">
      <div class="form-group">
        <label for="username">Your Name:</label>
        <input type="text" id="username" placeholder="Enter your name">
      </div>
      <button class="btn-primary" onclick="startTest()">Start Test</button>
    </div>

    <div id="timer" class="timer">Time left: 10:00</div>

    <form id="quizForm">
      <div id="questions"></div>
      <div class="actions">
        <button type="button" class="btn-primary" onclick="checkAnswers()">Check Answers</button>
      </div>
    </form>

    <div id="result" class="quiz-container" style="display: none;"></div>

    <section id="leaderboard" class="leaderboard">
      <h2>üèÜ Leaderboard</h2>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody id="scoreList"></tbody>
      </table>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <p>&copy; 2025 English Learning Platform. Created for my portfolio.</p>
    </div>
  </footer>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDolx1CGyygN_sbWphyHCcE-twTM1L_U5A",
      authDomain: "english-test-5454b.firebaseapp.com",
      databaseURL: "https://english-test-5454b-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "english-test-5454b",
      storageBucket: "english-test-5454b.appspot.com",
      messagingSenderId: "325979388906",
      appId: "1:325979388906:web:9dd9c3fec2330d97bad093",
      measurementId: "G-JL3WK4R83C"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let countdown;
    let timeLeft = 600;

    const questions = [
      { 
        q: "She ____ (watch) TV now.", 
        options: { a: "is watching", b: "watch", c: "watches", d: "watched" }, 
        answer: "a", 
        explanation: "Present Continuous: is + verb-ing for actions happening now." 
      },
      { 
        q: "I ____ (read) a book at the moment.", 
        options: { a: "am reading", b: "read", c: "reads", d: "reading" }, 
        answer: "a", 
        explanation: "For 'I': am + verb-ing." 
      },
      { 
        q: "They ____ (play) football right now.", 
        options: { a: "play", b: "are playing", c: "played", d: "plays" }, 
        answer: "b", 
        explanation: "Plural subject ‚Üí are + verb-ing." 
      },
      { 
        q: "He ____ (not / work) today.", 
        options: { a: "is not working", b: "does not work", c: "was not working", d: "not working" }, 
        answer: "a", 
        explanation: "Negative form: is not + verb-ing." 
      },
      { 
        q: "____ you ____ (do) your homework now?", 
        options: { a: "Are / doing", b: "Do / do", c: "Did / doing", d: "Is / doing" }, 
        answer: "a", 
        explanation: "Question: Are you doing...?" 
      },
      { 
        q: "My friends ____ (study) English at the moment.", 
        options: { a: "are studying", b: "study", c: "studies", d: "studied" }, 
        answer: "a", 
        explanation: "Plural ‚Üí are + verb-ing." 
      },
      { 
        q: "The sun ____ (shine) right now.", 
        options: { a: "is shining", b: "shines", c: "shine", d: "shone" }, 
        answer: "a", 
        explanation: "Present Continuous: is shining for action happening now." 
      },
      { 
        q: "We ____ (not / watch) TV, we are reading.", 
        options: { a: "are not watching", b: "don't watch", c: "isn't watching", d: "not watching" }, 
        answer: "a", 
        explanation: "Negative: are not + verb-ing." 
      },
      { 
        q: "____ she ____ (talk) to her friend?", 
        options: { a: "Is / talking", b: "Does / talk", c: "Was / talking", d: "Has / talked" }, 
        answer: "a", 
        explanation: "Question: Is she talking?" 
      },
      { 
        q: "I ____ (not / listen) to music right now.", 
        options: { a: "am not listening", b: "don't listen", c: "wasn't listening", d: "not listening" }, 
        answer: "a", 
        explanation: "Negative: am not + verb-ing." 
      },
      { 
        q: "Look! The children ____ (play) outside.", 
        options: { a: "are playing", b: "play", c: "played", d: "plays" }, 
        answer: "a", 
        explanation: "Right now ‚Üí are playing." 
      },
      { 
        q: "She ____ (cook) dinner at the moment.", 
        options: { a: "is cooking", b: "cooks", c: "cooked", d: "cook" }, 
        answer: "a", 
        explanation: "Now ‚Üí is cooking." 
      },
      { 
        q: "We ____ (not / sleep) now.", 
        options: { a: "are not sleeping", b: "don't sleep", c: "aren't sleep", d: "not sleeping" }, 
        answer: "a", 
        explanation: "Negative: are not + verb-ing." 
      },
      { 
        q: "____ he ____ (drive) to work now?", 
        options: { a: "Is / driving", b: "Does / drive", c: "Was / driving", d: "Has / driven" }, 
        answer: "a", 
        explanation: "Question: Is he driving?" 
      },
      { 
        q: "Listen! The birds ____ (sing).", 
        options: { a: "are singing", b: "sing", c: "sings", d: "sang" }, 
        answer: "a", 
        explanation: "Now ‚Üí are singing." 
      },
      { 
        q: "I ____ (write) an email right now.", 
        options: { a: "am writing", b: "write", c: "writes", d: "wrote" }, 
        answer: "a", 
        explanation: "For 'I': am + writing." 
      },
      { 
        q: "She ____ (not / read) the newspaper.", 
        options: { a: "is not reading", b: "does not read", c: "was not reading", d: "isn't read" }, 
        answer: "a", 
        explanation: "Negative Present Continuous." 
      },
      { 
        q: "____ you ____ (watch) the movie now?", 
        options: { a: "Are / watching", b: "Do / watch", c: "Did / watching", d: "Is / watching" }, 
        answer: "a", 
        explanation: "Question: Are you watching?" 
      },
      { 
        q: "He ____ (run) in the park at the moment.", 
        options: { a: "is running", b: "runs", c: "ran", d: "running" }, 
        answer: "a", 
        explanation: "Now ‚Üí is running." 
      },
      { 
        q: "We ____ (have) lunch now.", 
        options: { a: "are having", b: "have", c: "had", d: "has" }, 
        answer: "a", 
        explanation: "Present Continuous: are having." 
      }
    ];

    function startTest() {
      const name = document.getElementById("username").value.trim();
      if (!name) {
        alert("Please enter your name before you start.");
        return;
      }
      document.getElementById("quizForm").style.display = "block";
      document.getElementById("timer").style.display = "block";
      document.getElementById("introSection").style.display = "none";
      renderQuestions();
      startTimer();
      updateLeaderboard();
    }

    function renderQuestions() {
      const container = document.getElementById("questions");
      container.innerHTML = "";
      questions.forEach((item, index) => {
        const optionHtml = Object.keys(item.options).map(letter =>
          `<label class="options"><input type="radio" name="q${index}" value="${letter}"> (${letter}) ${item.options[letter]}</label>`
        ).join("");
        container.insertAdjacentHTML("beforeend", `
          <div class="question">
            <p>${item.q}</p>
            <div class="options">${optionHtml}</div>
            <span id="f${index}" class="feedback"></span>
            <div id="e${index}" class="explanation"></div>
          </div>
        `);
      });
    }

    function startTimer() {
      const timerDisplay = document.getElementById("timer");
      timerDisplay.textContent = "Time left: " + formatTime(timeLeft);
      countdown = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = "Time left: " + formatTime(timeLeft);
        if (timeLeft <= 0) {
          clearInterval(countdown);
          timerDisplay.textContent = "‚è∞ Time is up!";
          checkAnswers();
        }
      }, 1000);
    }

    function formatTime(seconds) {
      const m = String(Math.floor(seconds / 60)).padStart(2, '0');
      const s = String(seconds % 60).padStart(2, '0');
      return `${m}:${s}`;
    }

    function checkAnswers() {
      let score = 0;
      questions.forEach((item, index) => {
        const radios = document.getElementsByName(`q${index}`);
        let selected = "";
        for (const r of radios) if (r.checked) selected = r.value;
        const feedback = document.getElementById(`f${index}`);
        const explanation = document.getElementById(`e${index}`);
        if (selected === item.answer) {
          feedback.textContent = "‚úîÔ∏è Correct";
          feedback.className = "feedback correct";
          explanation.textContent = "";
          score += 5;
        } else {
          feedback.textContent = "‚ùå Incorrect";
          feedback.className = "feedback incorrect";
          const correctLetter = item.answer.toUpperCase();
          const correctText = item.options[item.answer];
          explanation.textContent = `Correct answer: (${correctLetter}) ${correctText}. ${item.explanation}`;
        }
      });
      const username = document.getElementById("username").value.trim();
      const resultElement = document.getElementById("result");
      resultElement.style.display = "block";
      resultElement.innerHTML = `<h3>Your Score: ${score} / ${questions.length * 5}</h3>`;
      
      if (username) {
        db.ref("scores_present_continuous").push({ name: username, score });
      }
      
      updateLeaderboard();
      clearInterval(countdown);
    }

    function updateLeaderboard() {
      db.ref("scores_present_continuous").orderByChild("score").limitToLast(5).once("value", snapshot => {
        const list = document.getElementById("scoreList");
        list.innerHTML = "";
        const data = [];
        snapshot.forEach(child => data.push(child.val()));
        data.reverse().forEach((s, i) => {
          const row = document.createElement("tr");
          let rankClass = "";
          if (i === 0) rankClass = "medal-gold";
          else if (i === 1) rankClass = "medal-silver";
          else if (i === 2) rankClass = "medal-bronze";
          
          row.innerHTML = `<td class="${rankClass}">${i + 1}</td><td>${s.name}</td><td>${s.score}</td>`;
          list.appendChild(row);
        });
      });
    }

    // Initialize leaderboard
    updateLeaderboard();
  </script>
</body>
</html>