<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test: Past Simple</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>
  <header>
    <div class="header-content">
      <h1>Past Simple Test</h1>
      <p>Test your knowledge of completed actions in the past</p>
    </div>
  </header>

  <nav>
    <input type="checkbox" id="mobile-menu-toggle" class="mobile-menu-toggle">
    <label for="mobile-menu-toggle" class="hamburger">
        <span></span>
        <span></span>
        <span></span>
    </label>
    <div class="nav-container">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li>
          <a href="rules.html">Grammar Rules</a>
          <ul>
            <li><a href="rule-present-simple.html">Present Simple</a></li>
            <li><a href="rule-present-continuous.html">Present Continuous</a></li>
            <li><a href="rule-past-simple.html">Past Simple</a></li>
            <li><a href="rule-future-simple.html">Future Simple</a></li>
            <li><a href="rule-articles.html">Articles</a></li>
          </ul>
        </li>
        <li>
          <a href="dictionary.html">Dictionary</a>
          <ul>
            <li><a href="verbs.html">Irregular Verbs</a></li>
            <li><a href="word-cards.html">Word Cards</a></li>
          </ul>
        </li>
        <li>
          <a href="tests.html">Tests</a>
          <ul>
            <li><a href="comperalative.html">Comparative & Superlative</a></li>
            <li><a href="past-simple-test.html" class="nav-active">Past Simple Test</a></li>
            <li><a href="present-simple-test.html">Present Simple Test</a></li>
            <li><a href="present-continuous-test.html">Present Continuous Test</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <main>
    <section class="hero">
      <div class="hero-content">
        <h2>Past Simple Tense Test</h2>
        <p>Test your understanding of completed actions and events in the past</p>
      </div>
    </section>

    <div class="test-instructions">
      <h3>Test Instructions</h3>
      <p>You have <strong>10 minutes</strong> to complete 20 questions. Choose the correct past form of the verb for each sentence. Good luck!</p>
    </div>

    <div class="intro" id="introSection">
      <div class="form-group">
        <label for="username">Your Name:</label>
        <input type="text" id="username" placeholder="Enter your name">
      </div>
      <button class="btn-primary" onclick="startTest()">Start Test</button>
    </div>

    <div id="timer" class="timer">Time left: 10:00</div>

    <form id="quizForm">
      <div id="questions"></div>
      <div class="actions">
        <button type="button" class="btn-primary" onclick="checkAnswers()">Check Answers</button>
      </div>
    </form>

    <div id="result" class="quiz-container" style="display: none;"></div>

    <section id="leaderboard" class="leaderboard">
      <h2>üèÜ Leaderboard</h2>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody id="scoreList"></tbody>
      </table>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <p>&copy; 2025 English Learning Platform. Created for my portfolio.</p>
    </div>
  </footer>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDolx1CGyygN_sbWphyHCcE-twTM1L_U5A",
      authDomain: "english-test-5454b.firebaseapp.com",
      databaseURL: "https://english-test-5454b-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "english-test-5454b",
      storageBucket: "english-test-5454b.appspot.com",
      messagingSenderId: "325979388906",
      appId: "1:325979388906:web:9dd9c3fec2330d97bad093",
      measurementId: "G-JL3WK4R83C"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let countdown;
    let timeLeft = 600;

    const questions = [
      {
        q: "We ____ to the park yesterday.",
        options: { a: "go", b: "goes", c: "went", d: "going" },
        answer: "c",
        explanation: "Past Simple of 'go' is 'went'."
      },
      {
        q: "She ____ dinner at 7 pm last night.",
        options: { a: "cook", b: "cooked", c: "cooks", d: "is cooking" },
        answer: "b",
        explanation: "Regular verb in Past Simple: 'cooked'."
      },
      {
        q: "They ____ the movie two days ago.",
        options: { a: "watch", b: "watched", c: "are watching", d: "watches" },
        answer: "b",
        explanation: "Past Simple with 'ago' ‚Üí 'watched'."
      },
      {
        q: "____ you see Tom at the party?",
        options: { a: "Do", b: "Did", c: "Are", d: "Were" },
        answer: "b",
        explanation: "Questions in Past Simple use 'Did' + base verb."
      },
      {
        q: "I ____ my homework, but it was difficult.",
        options: { a: "do", b: "did", c: "does", d: "doing" },
        answer: "b",
        explanation: "Past Simple of 'do' is 'did'."
      },
      {
        q: "She ____ not (didn't) like the soup.",
        options: { a: "did", b: "does", c: "didn't", d: "was" },
        answer: "c",
        explanation: "Negative in Past Simple: 'did not (didn't)' + base verb."
      },
      {
        q: "We ____ in London in 2015.",
        options: { a: "were", b: "are", c: "was", d: "be" },
        answer: "a",
        explanation: "'We' in Past Simple of 'be' ‚Üí 'were'."
      },
      {
        q: "He ____ to school by bus last week.",
        options: { a: "go", b: "went", c: "was going", d: "has gone" },
        answer: "b",
        explanation: "Past Simple completed action ‚Üí 'went'."
      },
      {
        q: "____ she finish the report on time?",
        options: { a: "Do", b: "Is", c: "Did", d: "Has" },
        answer: "c",
        explanation: "Use 'Did' for Past Simple questions."
      },
      {
        q: "I ____ very tired after the trip.",
        options: { a: "am", b: "were", c: "was", d: "be" },
        answer: "c",
        explanation: "Past Simple of 'be' for 'I' ‚Üí 'was'."
      },
      {
        q: "We ____ any photos because the camera was broken.",
        options: { a: "don't take", b: "didn't take", c: "weren't taking", d: "hasn't taken" },
        answer: "b",
        explanation: "Negative Past Simple: 'didn't take'."
      },
      {
        q: "They ____ a new car last month.",
        options: { a: "buyed", b: "buys", c: "bought", d: "buy" },
        answer: "c",
        explanation: "Irregular verb: 'buy' ‚Üí 'bought'."
      },
      {
        q: "Where ____ you born?",
        options: { a: "did", b: "were", c: "was", d: "are" },
        answer: "b",
        explanation: "For birth, use 'were/was born' (Past of 'be')."
      },
      {
        q: "She ____ an email and then turned off her laptop.",
        options: { a: "writes", b: "wrote", c: "has written", d: "is writing" },
        answer: "b",
        explanation: "Sequence of finished actions ‚Üí Past Simple 'wrote'."
      },
      {
        q: "They ____ to the concert because they didn't have tickets.",
        options: { a: "went", b: "didn't go", c: "don't go", d: "weren't go" },
        answer: "b",
        explanation: "Negative Past Simple: 'didn't go'."
      },
      {
        q: "I ____ breakfast at 8, and then I left home.",
        options: { a: "eat", b: "eated", c: "ate", d: "was eating" },
        answer: "c",
        explanation: "Irregular verb: 'eat' ‚Üí 'ate'."
      },
      {
        q: "We ____ the museum on Saturday morning.",
        options: { a: "visited", b: "visit", c: "were visiting", d: "have visited" },
        answer: "a",
        explanation: "Finished action at a specific time ‚Üí 'visited'."
      },
      {
        q: "He ____ late, so we missed the bus.",
        options: { a: "arrives", b: "arrived", c: "has arrived", d: "was arriving" },
        answer: "b",
        explanation: "Past Simple for a completed event ‚Üí 'arrived'."
      },
      {
        q: "Did you ____ the game yesterday?",
        options: { a: "watched", b: "watch", c: "watches", d: "watching" },
        answer: "b",
        explanation: "After 'Did', use base form: 'watch'."
      },
      {
        q: "There ____ many people at the meeting.",
        options: { a: "is", b: "was", c: "were", d: "be" },
        answer: "c",
        explanation: "Plural subject in Past of 'be' ‚Üí 'were'."
      }
    ];

    function startTest() {
      const name = document.getElementById("username").value.trim();
      if (!name) {
        alert("Please enter your name before you start.");
        return;
      }
      document.getElementById("quizForm").style.display = "block";
      document.getElementById("timer").style.display = "block";
      document.getElementById("introSection").style.display = "none";
      renderQuestions();
      startTimer();
      updateLeaderboard();
    }

    function renderQuestions() {
      const container = document.getElementById("questions");
      container.innerHTML = "";
      questions.forEach((item, index) => {
        const opts = item.options;
        const optionHtml = Object.keys(opts).map(letter => {
          const text = opts[letter];
          return `<label class="options"><input type="radio" name="q${index}" value="${letter}"> (${letter}) ${text}</label>`;
        }).join("");
        container.insertAdjacentHTML("beforeend", `
          <div class="question">
            <p>${item.q}</p>
            <div class="options">${optionHtml}</div>
            <span id="f${index}" class="feedback"></span>
            <div id="e${index}" class="explanation"></div>
          </div>
        `);
      });
    }

    function startTimer() {
      const timerDisplay = document.getElementById("timer");
      timerDisplay.textContent = "Time left: " + formatTime(timeLeft);
      countdown = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = "Time left: " + formatTime(timeLeft);
        if (timeLeft <= 0) {
          clearInterval(countdown);
          timerDisplay.textContent = "‚è∞ Time is up!";
          checkAnswers();
        }
      }, 1000);
    }

    function formatTime(seconds) {
      const m = String(Math.floor(seconds / 60)).padStart(2, '0');
      const s = String(seconds % 60).padStart(2, '0');
      return `${m}:${s}`;
    }

    function checkAnswers() {
      let score = 0;
      questions.forEach((item, index) => {
        const radios = document.getElementsByName(`q${index}`);
        let selected = "";
        for (const r of radios) if (r.checked) selected = r.value;

        const feedback = document.getElementById(`f${index}`);
        const explanation = document.getElementById(`e${index}`);

        if (selected === item.answer) {
          feedback.textContent = "‚úîÔ∏è Correct";
          feedback.className = "feedback correct";
          explanation.textContent = "";
          score += 5;
        } else {
          feedback.textContent = "‚ùå Incorrect";
          feedback.className = "feedback incorrect";
          const correctLetter = item.answer.toUpperCase();
          const correctText = item.options[item.answer];
          explanation.textContent = `Correct answer: (${correctLetter}) ${correctText}. ${item.explanation}`;
        }
      });

      const username = document.getElementById("username").value.trim();
      const resultElement = document.getElementById("result");
      resultElement.style.display = "block";
      resultElement.innerHTML = `<h3>Your Score: ${score} / ${questions.length * 5}</h3>`;

      if (username) {
        db.ref("scores_past_simple").push({ name: username, score });
      }

      updateLeaderboard();
      clearInterval(countdown);
    }

    function updateLeaderboard() {
      db.ref("scores_past_simple").orderByChild("score").limitToLast(5).once("value", snapshot => {
        const list = document.getElementById("scoreList");
        list.innerHTML = "";
        const data = [];
        snapshot.forEach(child => data.push(child.val()));
        data.reverse().forEach((s, i) => {
          const row = document.createElement("tr");
          let rankClass = "";
          if (i === 0) rankClass = "medal-gold";
          else if (i === 1) rankClass = "medal-silver";
          else if (i === 2) rankClass = "medal-bronze";
          
          row.innerHTML = `<td class="${rankClass}">${i + 1}</td><td>${s.name}</td><td>${s.score}</td>`;
          list.appendChild(row);
        });
      });
    }

    // Initialize leaderboard
    updateLeaderboard();
  </script>
</body>
</html>